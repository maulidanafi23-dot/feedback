<!doctype html>
<html lang="id">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Dashboard Feedback</title>
  <style>
    body {
      background: #dfdddd;
      font-family: "inter", sans-serif;
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
      margin: 0;
    }
    .card {
      background: #f5f1f1;
      border-radius: 16px;
      box-shadow: 0 4px 16px rgba(65,3,3,0.15);
      width: 90%;
      max-width: 420px;
      padding: 20px;
      text-align: center;
    }
    h2 { 
      margin: 0 0 8px; 
      font-size: 26px; 
      color:#4b0e0e; 
    }
    p { 
      margin: 0 0 12px; 
      font-size: 14px; 
      color:#333;
    }
    .emoji-container {
      height: 64px;
      margin-bottom: 10px;
      display: flex;
      justify-content: center;
      align-items: center;
    }
    .emoji {
      font-size: 60px;
      display: inline-block;
    }
    .slide {
      animation: slideLeft 0.4s ease;
    }
    @keyframes slideLeft {
      0% { transform: translateX(0); opacity: 1; }
      40% { transform: translateX(-60px); opacity: 0; }
      60% { transform: translateX(60px); opacity: 0; }
      100% { transform: translateX(0); opacity: 1; }
    }
    .stars {
      display: flex;
      justify-content: center;
      gap: 6px;
      margin-bottom: 10px;
    }
    .star {
      font-size: 34px;
      color: #ccc;
      cursor: pointer;
      transition: transform .2s;
    }
    .star:hover { transform: scale(1.4); }
    .star.selected { color: #ffb400; }

    .emoji-label {
      font-size: 12px;
      color: #555;
      margin-bottom: 12px;
    }

    .suggestions {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      justify-content: center;
      margin-bottom: 10px;
    }
    .chip {
      background: #e0e0e0;
      border-radius: 20px;
      padding: 5px 12px;
      font-size: 12px;
      cursor: pointer;
      border: 1px solid #ddd;
      transition: all 0.2s;
      user-select: none;
    }
    .chip.selected {
      background: #ffecec;
      border-color: #4b0e0e;
      color: #4b0e0e;
      font-weight: bold;
    }
    textarea {
      width: 100%;
      min-height: 80px;
      border: 1px solid #ccc;
      border-radius: 6px;
      padding: 10px;
      margin-bottom: 16px;
      resize: vertical;
      font-family: inherit;
      box-sizing: border-box; /* ini yg penting baiar ga nempel card*/
    }
    /* Tambahan biar jarak aman di kanan kiri */
    .card {
    padding: 20px 24px;  /* kanan kiri agak lebar */
    box-sizing: border-box;
    }
    button {
      width: 100%; 
      padding: 10px;
      background: #4b0e0e;
      color: white;
      font-weight: bold;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      font-size: 15px;
      transition: transform 0.2s;
    }
    button.clicked {
      animation: buttonClick 0.3s ease;
    }
    @keyframes buttonClick {
      0% { transform: scale(1); box-shadow: none; }
      40% { transform: scale(0.95); box-shadow: 0 0 12px rgba(75,14,14,0.5); }
      100% { transform: scale(1); box-shadow: none; }
    }
    .popup {
      display: none;
      position: fixed;
      top: 0; left: 0; right: 0; bottom: 0;
      background: rgba(0,0,0,0.5);
      justify-content: center;
      align-items: center;
    }
    .popup-content {
      background: #fff;
      color: #333;
      padding: 24px;
      border-radius: 10px;
      text-align: center;
      max-width: 280px;
    }
    .popup-content h3 {
      margin: 0 0 10px;
      color: #16a34a;
    }
  </style>
</head>
<body>
  <div class="card" id="card">
    <h2>Give Your Feedback</h2>
    <p>Bagaimana pengalaman Anda dengan layanan kami?</p>
    <div class="emoji-container">
      <div class="emoji" id="emoji">ðŸ™‚</div>
    </div>
    <div class="emoji-label" id="emojiLabel">Cukup Puas</div>
    <div class="stars" id="stars">
      <span class="star" data-value="1">â˜…</span>
      <span class="star" data-value="2">â˜…</span>
      <span class="star" data-value="3">â˜…</span>
      <span class="star" data-value="4">â˜…</span>
      <span class="star" data-value="5">â˜…</span>
    </div>

    <div class="suggestions" id="suggestions">
      <div class="chip">Layanan cepat dan responsif</div>
      <div class="chip">Pendamping ramah dan solutif</div>
      <div class="chip">Sangat membantu</div>
      <div class="chip">Informasi lengkap dan bermanfaat</div>
      <div class="chip">Mudah diakses</div>
      <div class="chip">Media panduan informatif</div>
    </div>
  
    <textarea id="review" placeholder="Tulis ulasan Anda..."></textarea>
    <button id="submitBtn">Submit</button>
  </div>

  <div class="popup" id="popup">
    <div class="popup-content">
      <div style="font-size:48px;">âœ…</div>
      <h3>Terima kasih!</h3>
      <p>Feedback telah tersimpan</p>
    </div>
  </div>

  <script>
    const stars = document.querySelectorAll('.star');
    const emojiEl = document.getElementById('emoji');
    const emojiLabel = document.getElementById('emojiLabel');
    const submitBtn = document.getElementById('submitBtn');
    const popup = document.getElementById('popup');
    const chips = document.querySelectorAll('.chip');
    let currentRating = 0;

    const emojiMap = {
      1: "ðŸ˜¡", 2: "ðŸ˜ž", 3: "ðŸ˜", 4: "ðŸ˜Š", 5: "ðŸ¤©",
    };
    const labelMap = {
      1: "Sangat Tidak Puas",
      2: "Tidak Puas",
      3: "Cukup Puas",
      4: "Puas",
      5: "Sangat Puas",
    };

    function selectRating(r) {
      currentRating = r;
      stars.forEach(s => {
        const v = Number(s.dataset.value);
        if (v <= r) s.classList.add('selected');
        else s.classList.remove('selected');
      });
      emojiEl.textContent = emojiMap[r];
      emojiLabel.textContent = labelMap[r];
      emojiEl.classList.remove("slide");
      void emojiEl.offsetWidth;
      emojiEl.classList.add("slide");
    }

    stars.forEach(s => s.addEventListener('click', () => selectRating(Number(s.dataset.value))));

    // blok chip
    chips.forEach(chip => {
      chip.addEventListener('click', () => {
        chip.classList.toggle('selected');
      });
    });

    const scriptURL = "https://script.google.com/macros/s/AKfycbxuuXI5G34AwEzOY97lCm6sNJjzMEC9Z6GlSnl47CO92xw9zDtX5W-IjljmHaklua4Ibw/exec";

    submitBtn.addEventListener('click', async (e) => {
      e.preventDefault();
      submitBtn.classList.add("clicked");
      setTimeout(() => submitBtn.classList.remove("clicked"), 300);

      const review = document.getElementById('review').value;
      if (!currentRating) return alert("Pilih rating dulu!");
      if (!review.trim()) return alert("Tulis ulasan Anda!");

      const selectedChips = Array.from(document.querySelectorAll('.chip.selected')).map(c => c.textContent);
      const ratingToSend = currentRating;
      const emojiToSend  = emojiEl.textContent;
      const labelToSend  = emojiLabel.textContent;

      try {
        const response = await fetch(scriptURL, {
          method: "POST",
          body: JSON.stringify({
            rating: ratingToSend,
            emoji: emojiToSend,
            label: labelToSend,
            review: review,
            suggestion: selectedChips.join(", ")
          }),
          headers: { "Content-Type": "text/plain" }
        });

        if (response.ok) {
          popup.style.display = "flex";
          setTimeout(() => popup.style.display = "none", 4000);

          // Reset form
          document.getElementById('review').value = "";
          stars.forEach(s => s.classList.remove("selected"));
          chips.forEach(c => c.classList.remove("selected"));
          emojiEl.textContent = "ðŸ™‚";
          emojiLabel.textContent = "";
        } else {
          alert("Gagal menyimpan data, coba lagi!");
        }
      } catch (err) {
        console.error("Gagal kirim feedback:", err);
        alert("Terjadi kesalahan koneksi!");
      }
    });
  </script>
</body>
</html>






